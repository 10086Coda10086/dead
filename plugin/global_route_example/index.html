<h3>全局路由示例插件</h3>
<p>{{ c.message }}</p>
<p>此插件演示了如何使用全局路由功能。</p>

<div class="route-info">
    <h4>可用路由：</h4>
    <ul>
        <li>
            <strong>插件命名空间路由：</strong> 
            <a href="/plugin/global_route_example/hello" target="_blank">/plugin/global_route_example/hello</a>
        </li>
        <li>
            <strong>全局路由：</strong> 
            <a href="/hello" target="_blank">/hello</a>
        </li>
        <li>
            <strong>带参数的全局路由：</strong> 
            <a href="/greet/user" target="_blank">/greet/user</a>
        </li>
        <li>
            <strong>支持多种HTTP方法的全局路由：</strong> 
            <a href="/api/data" target="_blank">/api/data</a> (GET/POST)
        </li>
    </ul>
</div>

<div class="route-test">
    <h4>测试POST请求：</h4>
    <div class="form-group">
        <label for="post-data">JSON数据：</label>
        <textarea id="post-data" rows="4" style="width: 100%;">{"name": "Test User", "message": "Hello from form"}</textarea>
    </div>
    <button id="send-post" class="gh-button">发送POST请求</button>
    <div id="post-result" style="margin-top: 10px; padding: 10px; border: 1px solid #ccc; display: none;"></div>
</div>

<script>
    // 发送POST请求
    document.getElementById('send-post').addEventListener('click', async function() {
        try {
            const postData = document.getElementById('post-data').value;
            const resultElement = document.getElementById('post-result');
            
            // 解析JSON
            let jsonData;
            try {
                jsonData = JSON.parse(postData);
            } catch (e) {
                resultElement.textContent = '错误：无效的JSON数据';
                resultElement.style.display = 'block';
                return;
            }
            
            // 发送请求
            const response = await fetch('/api/data', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: postData
            });
            
            const data = await response.json();
            
            // 显示结果
            resultElement.textContent = JSON.stringify(data, null, 2);
            resultElement.style.display = 'block';
        } catch (error) {
            console.error('请求错误:', error);
            document.getElementById('post-result').textContent = '请求错误: ' + error.message;
            document.getElementById('post-result').style.display = 'block';
        }
    });
</script>
